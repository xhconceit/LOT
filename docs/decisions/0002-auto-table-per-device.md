# ADR-0002：设备自动建表（每设备一张表）

## 状态

提议（Draft）

## 背景

希望设备“接入即能入库”，同时按设备隔离数据以简化查询与数据管理。

## 决策

采用“每设备一张表”的自动建表策略：

- 首次观察到新的 `deviceId` 时触发建表
- 表名示例：`telemetry_{deviceId}`（需做合法化与长度限制）
- 最小字段集合与索引见 `docs/data-spec.md`

Schema 演进策略默认使用 **固定字段 + payload_raw(JSONB)**，避免频繁 DDL。

## 影响

- **正面**：单表体量可控；按设备清理/归档更直接
- **代价**：设备数很大时表数量膨胀；需要管理 DDL 并发与权限

## 备选方案（未选）

- 单大表按 `deviceId` 分区（Partition）
- 时序数据库（如 Timescale/InfluxDB）
